---
// Header.astro - Frical Alimentos
// Header glassmorphism estilo futurista

const menuItems = [
  { name: 'Sobre', href: '/sobre' },
  { 
    name: 'Produtos', 
    href: '/produtos',
    submenu: [
      { name: 'Prime Baby', href: '/produtos/prime-baby' },
      { name: 'Premium Grill', href: '/produtos/premium-grill' },
      { name: 'Tradicional Bovino', href: '/produtos/tradicional-bovino' },
      { name: 'Palatto Bovino', href: '/produtos/palatto-bovino' },
      { name: 'Palatto Suíno', href: '/produtos/palatto-suino' },
      { name: 'Tradicional Suíno', href: '/produtos/tradicional-suino' },
      { name: 'Carcaça Bovina', href: '/produtos/carcaca-bovina' },
      { name: 'Carcaça Suína', href: '/produtos/carcaca-suina' },
      { name: 'Miúdos', href: '/produtos/miudos' },
      { name: 'Pão de Queijo', href: '/produtos/pao-de-queijo' },
      { name: 'Industrializados', href: '/produtos/industrializados' },
    ]
  },
  { 
    name: 'Blog', 
    href: '/blog',
    submenu: [
      { name: 'Carnes', href: '/blog/carnes' },
      { name: 'Notícias', href: '/blog/noticias' },
      { name: 'Receitas', href: '/blog/receitas' },
    ]
  },
  { name: 'Política de Qualidade', href: '/politica-de-qualidade' },
  { 
    name: 'Contato', 
    href: 'https://api.whatsapp.com/send/?phone=553399198450&text&type=phone_number&app_absent=0',
    external: true 
  },
  { name: 'Trabalhe Conosco', href: '/trabalhe-conosco' },
];
---

<!-- HEADER DESKTOP -->
<header class="fixed top-0 left-0 right-0 z-50 hidden md:block">
  <div class="header-container">
    <nav class="header-nav">
      
      <!-- Logo -->
      <a href="/" class="header-logo">
        <img 
          src="/images/logo/logo.png" 
          alt="Frical Alimentos" 
        />
      </a>

      <!-- Menu Central -->
      <ul class="header-menu">
        {menuItems.map((item) => (
          <li class="menu-item">
            {item.submenu ? (
              <div class="dropdown-wrapper">
                <a href={item.href} class="menu-link">
                  {item.name}
                </a>
                <button class="dropdown-arrow" aria-label="Abrir submenu">
                  <svg viewBox="0 0 12 8" fill="currentColor">
                    <path d="M1.41 0L6 4.58L10.59 0L12 1.41L6 7.41L0 1.41L1.41 0Z"/>
                  </svg>
                </button>
                
                <!-- Dropdown -->
                <div class="dropdown-menu">
                  <div class="dropdown-content">
                    {item.submenu.map((sub) => (
                      <a href={sub.href} class="dropdown-item">
                        {sub.name}
                      </a>
                    ))}
                  </div>
                </div>
              </div>
            ) : (
              <a 
                href={item.href}
                class="menu-link"
                target={item.external ? '_blank' : undefined}
                rel={item.external ? 'noopener noreferrer' : undefined}
              >
                {item.name}
              </a>
            )}
          </li>
        ))}
      </ul>

    </nav>
  </div>
</header>

<!-- HEADER MOBILE -->
<header class="fixed top-0 left-0 right-0 z-50 md:hidden">
  <div class="mobile-header-container">
    <nav class="mobile-header-nav">
      <button id="mobile-toggle" class="mobile-logo-btn" aria-label="Abrir menu">
        <img 
          id="mobile-logo-img"
          src="/images/logo/logo.png" 
          alt="Frical Alimentos"
        />
        <span id="mobile-close-icon">✕</span>
      </button>
    </nav>
  </div>
</header>

<!-- Mobile Menu Overlay -->
<div id="mobile-overlay" class="mobile-overlay">
  <div id="mobile-panel" class="mobile-panel">
    <ul class="mobile-menu-list">
      {menuItems.map((item, idx) => (
        <li class="mobile-menu-item" style={`--i: ${idx}`}>
          {item.submenu ? (
            <div class="mobile-dropdown">
              <div class="mobile-dropdown-header">
                <a href={item.href} class="mobile-menu-link">
                  {item.name}
                </a>
                <button class="mobile-arrow-btn" aria-label="Expandir">
                  <svg viewBox="0 0 12 8" fill="currentColor">
                    <path d="M1.41 0L6 4.58L10.59 0L12 1.41L6 7.41L0 1.41L1.41 0Z"/>
                  </svg>
                </button>
              </div>
              <div class="mobile-submenu">
                {item.submenu.map((sub) => (
                  <a href={sub.href} class="mobile-submenu-link">
                    {sub.name}
                  </a>
                ))}
              </div>
            </div>
          ) : (
            <a 
              href={item.href}
              class="mobile-menu-link"
              target={item.external ? '_blank' : undefined}
            >
              {item.name}
            </a>
          )}
        </li>
      ))}
    </ul>
  </div>
</div>

<!-- Espaçador -->
<div class="h-32 md:h-36"></div>

<style>
  /* ============================================
     DESKTOP HEADER
     ============================================ */
  
  .header-container {
    padding: 24px 48px;
  }

  @media (min-width: 1400px) {
    .header-container {
      padding: 24px 80px;
    }
  }

  .header-nav {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 40px;
    background: linear-gradient(135deg, rgba(55, 70, 85, 0.88) 0%, rgba(45, 58, 72, 0.92) 100%);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 24px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 
      0 8px 32px rgba(0, 0, 0, 0.25),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }

  /* Logo */
  .header-logo {
    flex-shrink: 0;
    transition: transform 0.3s ease;
  }

  .header-logo:hover {
    transform: scale(1.05);
  }

  .header-logo img {
    height: 56px;
    width: auto;
  }

  /* Menu */
  .header-menu {
    display: flex;
    align-items: center;
    gap: 48px;
    list-style: none;
    margin: 0 auto;
    padding: 0;
  }

  .menu-item {
    position: relative;
  }

  .menu-link {
    font-family: 'Franklin Gothic Book', Arial, sans-serif;
    font-size: 15px;
    color: white;
    text-decoration: none;
    padding: 8px 0;
    transition: opacity 0.2s ease, transform 0.2s ease;
    display: inline-block;
  }

  .menu-link:hover {
    opacity: 0.85;
    transform: scale(1.03);
  }

  /* Dropdown Wrapper */
  .dropdown-wrapper {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .dropdown-arrow {
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    padding: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  .dropdown-arrow svg {
    width: 10px;
    height: 10px;
    transition: transform 0.3s ease;
  }

  .dropdown-arrow:hover {
    color: white;
  }

  /* Dropdown Menu */
  .dropdown-menu {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    padding-top: 20px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    pointer-events: none;
  }

  .dropdown-wrapper:hover .dropdown-menu {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
  }

  .dropdown-wrapper:hover .dropdown-arrow svg {
    transform: rotate(180deg);
  }

  .dropdown-content {
    background: rgba(255, 255, 255, 0.97);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 20px;
    padding: 16px 8px;
    min-width: 240px;
    box-shadow: 
      0 20px 60px rgba(0, 0, 0, 0.2),
      0 0 0 1px rgba(0, 0, 0, 0.05);
  }

  .dropdown-item {
    display: block;
    padding: 14px 24px;
    font-family: 'Franklin Gothic Book', Arial, sans-serif;
    font-size: 14px;
    color: #374151;
    text-decoration: none;
    border-radius: 12px;
    transition: all 0.2s ease;
  }

  .dropdown-item:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #111827;
  }

  /* ============================================
     MOBILE HEADER
     ============================================ */

  .mobile-header-container {
    padding: 16px 24px;
  }

  .mobile-header-nav {
    background: linear-gradient(135deg, rgba(55, 70, 85, 0.9) 0%, rgba(45, 58, 72, 0.95) 100%);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 20px;
    padding: 14px 24px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
  }

  .mobile-logo-btn {
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: none;
    border: none;
    cursor: pointer;
    position: relative;
    padding: 4px 0;
  }

  .mobile-logo-btn img {
    height: 44px;
    width: auto;
    transition: all 0.4s ease;
  }

  #mobile-close-icon {
    position: absolute;
    font-size: 24px;
    font-weight: bold;
    color: white;
    opacity: 0;
    transform: scale(0.5) rotate(-180deg);
    transition: all 0.4s ease;
  }

  .mobile-logo-btn.active img {
    opacity: 0;
    transform: scale(0.5) rotate(180deg);
  }

  .mobile-logo-btn.active #mobile-close-icon {
    opacity: 1;
    transform: scale(1) rotate(0);
  }

  /* Mobile Overlay */
  .mobile-overlay {
    position: fixed;
    inset: 0;
    z-index: 40;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s ease;
  }

  .mobile-overlay::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(8px);
  }

  .mobile-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  .mobile-panel {
    position: absolute;
    top: 100px;
    left: 24px;
    right: 24px;
    background: rgba(255, 255, 255, 0.97);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border-radius: 28px;
    padding: 32px;
    box-shadow: 
      0 25px 80px rgba(0, 0, 0, 0.25),
      0 0 0 1px rgba(0, 0, 0, 0.05);
    transform: translateY(-30px) scale(0.95);
    opacity: 0;
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .mobile-overlay.active .mobile-panel {
    transform: translateY(0) scale(1);
    opacity: 1;
  }

  .mobile-menu-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .mobile-menu-item {
    opacity: 0;
    transform: translateX(-20px);
    transition: all 0.4s ease;
    transition-delay: calc(var(--i) * 0.06s);
  }

  .mobile-overlay.active .mobile-menu-item {
    opacity: 1;
    transform: translateX(0);
  }

  .mobile-menu-link {
    display: block;
    padding: 18px 8px;
    font-family: 'Franklin Gothic Book', Arial, sans-serif;
    font-size: 17px;
    color: #1f2937;
    text-decoration: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    transition: color 0.2s ease;
  }

  .mobile-menu-link:hover {
    color: #111827;
  }

  /* Mobile Dropdown */
  .mobile-dropdown-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .mobile-dropdown-header .mobile-menu-link {
    flex: 1;
  }

  .mobile-arrow-btn {
    background: none;
    border: none;
    padding: 18px 8px;
    color: #9ca3af;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .mobile-arrow-btn svg {
    width: 12px;
    height: 12px;
    transition: transform 0.3s ease;
  }

  .mobile-arrow-btn:hover {
    color: #374151;
  }

  .mobile-dropdown.open .mobile-arrow-btn svg {
    transform: rotate(180deg);
  }

  .mobile-submenu {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease;
  }

  .mobile-dropdown.open .mobile-submenu {
    max-height: 600px;
  }

  .mobile-submenu-link {
    display: block;
    padding: 14px 8px 14px 24px;
    font-family: 'Franklin Gothic Book', Arial, sans-serif;
    font-size: 15px;
    color: #6b7280;
    text-decoration: none;
    border-left: 2px solid #e5e7eb;
    margin-left: 8px;
    transition: all 0.2s ease;
  }

  .mobile-submenu-link:hover {
    color: #1f2937;
    border-color: #9ca3af;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Mobile Toggle
    const toggle = document.getElementById('mobile-toggle');
    const overlay = document.getElementById('mobile-overlay');
    
    toggle?.addEventListener('click', () => {
      toggle.classList.toggle('active');
      overlay?.classList.toggle('active');
      document.body.style.overflow = overlay?.classList.contains('active') ? 'hidden' : '';
    });

    // Close on backdrop click
    overlay?.addEventListener('click', (e) => {
      if (e.target === overlay) {
        toggle?.classList.remove('active');
        overlay.classList.remove('active');
        document.body.style.overflow = '';
      }
    });

    // Mobile Dropdowns
    document.querySelectorAll('.mobile-arrow-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const dropdown = btn.closest('.mobile-dropdown');
        document.querySelectorAll('.mobile-dropdown.open').forEach(d => {
          if (d !== dropdown) d.classList.remove('open');
        });
        dropdown?.classList.toggle('open');
      });
    });

    // Close on link click
    overlay?.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        toggle?.classList.remove('active');
        overlay?.classList.remove('active');
        document.body.style.overflow = '';
      });
    });
  });
</script>